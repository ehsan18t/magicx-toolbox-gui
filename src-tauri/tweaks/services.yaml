# Services Tweaks - Disable unnecessary Windows services

category:
  id: services
  name: "Services"
  description: "Manage unnecessary Windows services"
  icon: "mdi:cogs"
  order: 5

tweaks:
  - id: disable_print_spooler
    name: "Disable Print Spooler"
    description: "Disable Windows Print Spooler service"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    info: "Disable if you don't use printing. Spooler service can be a security risk"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Spooler"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Spooler"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  - id: disable_fax_service
    name: "Disable Fax Service"
    description: "Disable Windows Fax and Scan service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Fax"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Fax"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  - id: disable_remote_registry
    name: "Disable Remote Registry"
    description: "Disable Remote Registry service"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    info: "Improves security by preventing remote registry access"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RemoteRegistry"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RemoteRegistry"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  - id: disable_xbox_services
    name: "Disable Xbox Services"
    description: "Disable Xbox Live Gaming Services"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\XboxGipSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\xbgm"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\XboxGipSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\xbgm"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  # NOTE: disable_connected_user_experiences removed - duplicate of disable_telemetry in privacy.yaml

  - id: disable_windows_error_reporting
    name: "Disable Windows Error Reporting"
    description: "Disable Windows Error Reporting service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WerSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WerSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  - id: disable_dmwappushservice
    name: "Disable Device Management WAP Push"
    description: "Disable WAP Push Message Routing Service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "Used for telemetry and push notifications from Microsoft"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\dmwappushservice"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\dmwappushservice"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  # NOTE: disable_sysmain (Superfetch) removed - duplicate of disable_superfetch in performance.yaml
  # NOTE: disable_windows_search removed - duplicate of disable_search_indexing in performance.yaml

  - id: disable_program_compatibility
    name: "Disable Program Compatibility Assistant"
    description: "Disable Program Compatibility Assistant service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "Reduces overhead from compatibility scanning"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\PcaSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\PcaSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_distributed_link_tracking
    name: "Disable Distributed Link Tracking"
    description: "Disable Distributed Link Tracking Client service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "Used for tracking file links across NTFS volumes. Rarely needed."
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TrkWks"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TrkWks"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_homegroup_provider
    name: "Disable HomeGroup Services"
    description: "Disable HomeGroup Provider service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "HomeGroup was removed in Windows 10 1803. Safe to disable on older Windows 10 builds."
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupProvider"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            windows_versions: [10]
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupListener"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            windows_versions: [10]
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupProvider"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            windows_versions: [10]
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupListener"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            windows_versions: [10]

  - id: disable_geolocation
    name: "Disable Geolocation Service"
    description: "Disable Windows Geolocation service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "Disables location tracking. Weather and maps apps may not work."
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\lfsvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\lfsvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_retail_demo
    name: "Disable Retail Demo Service"
    description: "Disable Windows Retail Demo service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RetailDemo"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RetailDemo"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_wallet_service
    name: "Disable Wallet Service"
    description: "Disable Windows Wallet Service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WalletService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WalletService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_security_center_service
    name: "Disable Windows Security Center"
    description: "Disable Windows Security Center service (wscsvc)"
    risk_level: high
    requires_admin: true
    requires_reboot: false
    info: "WARNING: Disables security status monitoring. You will not receive security alerts. Only recommended for advanced users."
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\wscsvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\wscsvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2

  - id: disable_touch_keyboard
    name: "Disable Touch Keyboard Service"
    description: "Disable Touch Keyboard and Handwriting Panel service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: "Safe to disable on non-touchscreen devices"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TabletInputService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TabletInputService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_cdpusersvc
    name: "Disable Connected Devices Platform"
    description: "Disable CDPUserSvc (Connected Devices Platform)"
    risk_level: low
    requires_admin: true
    requires_reboot: true
    info: "Used for device synchronization and timeline features"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\CDPUserSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\CDPUserSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2

  - id: disable_bits
    name: "Disable Background Intelligent Transfer"
    description: "Disable BITS (Background Intelligent Transfer Service)"
    risk_level: high
    requires_admin: true
    requires_reboot: true
    info: "WARNING: Disabling BITS breaks Windows Update. Only disable if you manage updates manually."
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\BITS"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\BITS"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
