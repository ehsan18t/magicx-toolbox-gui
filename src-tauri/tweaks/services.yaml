# Services Tweaks - Disable unnecessary Windows services

category:
  id: services
  name: "Services"
  description: "Manage unnecessary Windows services"
  icon: "mdi:cogs"
  order: 5

tweaks:
  - id: disable_print_spooler
    name: "Disable Print Spooler"
    description: "Disable Windows Print Spooler service"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the Windows Print Spooler service which manages print jobs.

      ## Security Consideration
      - Print Spooler has been targeted by several critical vulnerabilities (PrintNightmare)
      - Disabling eliminates this attack vector

      ## Impact
      - **Cannot print** when disabled
      - Print-to-PDF still works via Microsoft Print to PDF

      ## Recommendation
      Disable if you never print. Keep enabled if you use any printer.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Spooler"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Spooler"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  - id: disable_fax_service
    name: "Disable Fax Service"
    description: "Disable Windows Fax and Scan service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the Windows Fax and Scan service.

      ## When to Disable
      - You don't have a fax modem
      - You don't use Windows Fax and Scan app
      - Most home users don't need this

      ## Impact
      - No impact unless you actively use faxing
      - Scanning functionality may depend on other services

      ## Recommendation
      Safe to disable for nearly all users. Fax technology is largely obsolete.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Fax"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
        service_changes: []
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Fax"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 2
        service_changes: []

  # NOTE: disable_remote_registry moved to security.yaml
  # NOTE: disable_xbox_services moved to gaming.yaml

  # NOTE: disable_connected_user_experiences removed - duplicate of disable_telemetry in privacy.yaml
  # NOTE: disable_windows_error_reporting removed - duplicate of disable_windows_error_reporting_service in security.yaml
  # NOTE: disable_dmwappushservice moved to privacy.yaml (telemetry related)
  # NOTE: disable_geolocation moved to privacy.yaml (location tracking)
  # NOTE: disable_cdpusersvc moved to privacy.yaml (activity sync/timeline)

  # NOTE: disable_sysmain (Superfetch) removed - duplicate of disable_superfetch in performance.yaml
  # NOTE: disable_windows_search removed - duplicate of disable_search_indexing in performance.yaml

  - id: disable_program_compatibility
    name: "Disable Program Compatibility Assistant"
    description: "Disable Program Compatibility Assistant service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the Program Compatibility Assistant (PCA) service.

      ## What PCA Does
      - Detects known compatibility issues with older programs
      - Suggests compatibility modes after crashes
      - Monitors programs for potential problems

      ## When to Disable
      - You don't run legacy software
      - You want slightly faster program launches
      - You know how to set compatibility modes manually

      ## Recommendation
      Safe to disable. You can still right-click → Properties → Compatibility manually.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\PcaSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\PcaSvc"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_distributed_link_tracking
    name: "Disable Distributed Link Tracking"
    description: "Disable Distributed Link Tracking Client service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables tracking of linked files across NTFS volumes.

      ## What Link Tracking Does
      - Maintains shortcuts to files even after they're moved
      - Updates links when files are relocated on network
      - Works with NTFS object identifiers

      ## Modern Relevance
      - Rarely needed in modern workflows
      - Most users never notice this feature
      - Mainly useful in enterprise environments

      ## Recommendation
      Safe to disable. Broken shortcuts can be recreated manually.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TrkWks"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TrkWks"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  - id: disable_homegroup_provider
    name: "Disable HomeGroup Services"
    description: "Disable HomeGroup Provider service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the HomeGroup Provider and Listener services.

      ## Important Note
      - **HomeGroup was removed in Windows 10 version 1803**
      - These services don't exist in Windows 10 1803+ or Windows 11
      - Only affects older Windows 10 builds

      ## What HomeGroup Was
      - Simple home network file/printer sharing
      - Replaced by standard SMB sharing and OneDrive

      ## Recommendation
      Safe to disable. The feature is deprecated and removed in modern Windows.
    options:
      - label: "Disabled"
        registry_missing_is_match: true
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupProvider"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            windows_versions: [10]
            skip_validation: true
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupListener"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            windows_versions: [10]
            skip_validation: true
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupProvider"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            windows_versions: [10]
            skip_validation: true
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\HomeGroupListener"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            windows_versions: [10]
            skip_validation: true

  # NOTE: disable_geolocation moved to privacy.yaml (location tracking related)

  - id: disable_retail_demo
    name: "Disable Retail Demo Service"
    description: "Disable Windows Retail Demo service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the RetailDemo service used for store display demos.

      ## What Retail Demo Does
      - Powers the demo mode on store display PCs
      - Resets device to demo state after idle
      - Shows promotional content

      ## Typical Systems
      - Only present on devices configured for retail display
      - Most consumer PCs don't have this service
      - Safe to skip if service doesn't exist

      ## Recommendation
      Safe to disable. No impact unless you're running a retail demo device.
    options:
      - label: "Disabled"
        registry_missing_is_match: true
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RetailDemo"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            skip_validation: true
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\RetailDemo"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            skip_validation: true

  - id: disable_wallet_service
    name: "Disable Wallet Service"
    description: "Disable Windows Wallet Service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the WalletService used for NFC payment features.

      ## What Wallet Service Does
      - Manages NFC tap-to-pay functionality
      - Stores payment cards for contactless payments
      - Requires NFC-enabled hardware

      ## Availability
      - Not all Windows editions include this service
      - Requires compatible NFC hardware
      - Primarily for tablets and convertibles

      ## Recommendation
      Safe to disable unless you use NFC payments on your Windows device.
    options:
      - label: "Disabled"
        registry_missing_is_match: true
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WalletService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
            skip_validation: true
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\WalletService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
            skip_validation: true

  # NOTE: disable_security_center_service moved to security.yaml

  - id: disable_touch_keyboard
    name: "Disable Touch Keyboard Service"
    description: "Disable Touch Keyboard and Handwriting Panel service"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    info: |
      ## What This Does
      Disables the TabletInputService for touch keyboard and handwriting.

      ## What Gets Disabled
      - On-screen touch keyboard
      - Handwriting input panel
      - Touch/pen text input features

      ## When to Disable
      - Desktop PC without touchscreen
      - Laptop without touch input
      - You never use on-screen keyboard

      ## Note
      Some emoji picker features may be affected.

      ## Recommendation
      Safe to disable on non-touchscreen devices.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TabletInputService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\TabletInputService"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3

  # NOTE: disable_cdpusersvc moved to privacy.yaml (activity sync/timeline)

  - id: disable_bits
    name: "Disable Background Intelligent Transfer"
    description: "Disable BITS (Background Intelligent Transfer Service)"
    risk_level: high
    requires_admin: true
    requires_reboot: true
    info: |
      ## ⚠️ WARNING: High Risk Tweak

      ## What This Does
      Disables BITS which manages background file transfers.

      ## Critical Dependency
      - **Windows Update requires BITS**
      - Microsoft Store downloads use BITS
      - Many enterprise tools depend on it

      ## What Breaks
      - Windows Update stops working
      - Store app downloads fail
      - Some third-party software updates

      ## Recommendation
      **Only disable if you manage updates manually.** Not recommended for most users.
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\BITS"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 4
      - label: "Enabled (Default)"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\BITS"
            value_name: "Start"
            value_type: "REG_DWORD"
            value: 3
