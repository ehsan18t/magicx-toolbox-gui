# Security Tweaks - Improve Windows security settings

category:
  id: security
  name: "Security"
  description: "Improve Windows security settings"
  icon: "mdi:security"
  order: 4

tweaks:
  - id: disable_remote_desktop
    name: "Disable Remote Desktop"
    description: "Disable Remote Desktop Protocol (RDP) access"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Control\\Terminal Server"
            value_name: "fDenyTSConnections"
            value_type: "REG_DWORD"
            value: 1
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Control\\Terminal Server"
            value_name: "fDenyTSConnections"
            value_type: "REG_DWORD"
            value: 0

  - id: disable_autoplay
    name: "Disable AutoPlay"
    description: "Disable AutoPlay for removable drives"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
            value_name: "NoDriveTypeAutoRun"
            value_type: "REG_DWORD"
            value: 255
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
            value_name: "NoDriveTypeAutoRun"
            value_type: "REG_DWORD"
            value: 0

  - id: disable_autorun
    name: "Disable AutoRun Scripts"
    description: "Disable execution of autorun scripts"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
            value_name: "NoAutorun"
            value_type: "REG_DWORD"
            value: 1
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer"
            value_name: "NoAutorun"
            value_type: "REG_DWORD"
            value: 0

  - id: require_ctrlaltdel
    name: "Require Ctrl+Alt+Del to Unlock"
    description: "Require pressing Ctrl+Alt+Del for security screen"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Required"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
            value_name: "DisableCAD"
            value_type: "REG_DWORD"
            value: 0
      - label: "Not Required"
        registry_changes:
          - hive: HKLM
            key: "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
            value_name: "DisableCAD"
            value_type: "REG_DWORD"
            value: 1

  # NOTE: Guest account management removed - requires special SAM registry handling
  # Use 'net user Guest /active:no' command instead

  - id: disable_smbv1
    name: "Disable SMBv1 Protocol"
    description: "Disable legacy SMBv1 network protocol"
    risk_level: medium
    requires_admin: true
    requires_reboot: true
    info: "SMBv1 is an old protocol with security vulnerabilities"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
            value_name: "SMB1"
            value_type: "REG_DWORD"
            value: 0
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
            value_name: "SMB1"
            value_type: "REG_DWORD"
            value: 1

  - id: disable_netbios
    name: "Disable NetBIOS"
    description: "Disable NetBIOS over TCP/IP"
    risk_level: medium
    requires_admin: true
    requires_reboot: true
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\NetBT\\Parameters\\Interfaces\\Tcpip"
            value_name: "NetbiosOptions"
            value_type: "REG_DWORD"
            value: 2
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\NetBT\\Parameters\\Interfaces\\Tcpip"
            value_name: "NetbiosOptions"
            value_type: "REG_DWORD"
            value: 0

  - id: enforce_password_policy
    name: "Enforce Strong Password Policy"
    description: "Enforce strong password requirements"
    risk_level: low
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Enforced"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Netlogon\\Parameters"
            value_name: "RequireSignOrSeal"
            value_type: "REG_DWORD"
            value: 1
      - label: "Standard"
        registry_changes:
          - hive: HKLM
            key: "System\\CurrentControlSet\\Services\\Netlogon\\Parameters"
            value_name: "RequireSignOrSeal"
            value_type: "REG_DWORD"
            value: 0

  - id: disable_smartscreen
    name: "Disable SmartScreen"
    description: "Disable Windows SmartScreen filter"
    risk_level: high
    requires_admin: true
    requires_reboot: false
    info: "WARNING: Reduces security. Only disable if you know what you're doing"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\Windows\\System"
            value_name: "EnableSmartScreen"
            value_type: "REG_DWORD"
            value: 0
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\Windows\\System"
            value_name: "EnableSmartScreen"
            value_type: "REG_DWORD"
            value: 1

  - id: disable_defender_sample_submit
    name: "Disable Defender Sample Submission"
    description: "Prevent Windows Defender from automatically sending sample files to Microsoft"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    info: "Prevents automatic upload of suspicious files to Microsoft"
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\Windows Defender\\Spynet"
            value_name: "SubmitSamplesConsent"
            value_type: "REG_DWORD"
            value: 2
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\Windows Defender\\Spynet"
            value_name: "SubmitSamplesConsent"
            value_type: "REG_DWORD"
            value: 1

  - id: disable_defender_malware_report
    name: "Disable Defender Malware Reporting"
    description: "Disable automatic malware reporting to Microsoft"
    risk_level: medium
    requires_admin: true
    requires_reboot: false
    options:
      - label: "Disabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\MRT"
            value_name: "DontReportInfectionInformation"
            value_type: "REG_DWORD"
            value: 1
      - label: "Enabled"
        registry_changes:
          - hive: HKLM
            key: "Software\\Policies\\Microsoft\\MRT"
            value_name: "DontReportInfectionInformation"
            value_type: "REG_DWORD"
            value: 0
